<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=9"/>
		<meta name="generator" content="Doxygen 1.8.13"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		<title>Seismo-VLAB: Structure</title>
		<link href="tabs.css" rel="stylesheet" type="text/css"/>
		<script type="text/javascript" src="jquery.js"></script>
		<script type="text/javascript" src="dynsections.js"></script>
		<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
		<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
		<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
		<link href="doxygen.css" rel="stylesheet" type="text/css" />
		<link href="Style.css" rel="stylesheet" type="text/css"/>
	</head>
	<body>
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectlogo"><img alt="Logo" src="Logo.png"/></td>
						<td id="projectalign" style="padding-left: 0.5em;">
							<div id="projectname">Seismo-VLAB
								&#160;<span id="projectnumber">1.3</span>
							</div>
							<div id="projectbrief">An Open-Source Finite Element Software for Meso-Scale Simulations</div>
						</td>
						<td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('linkSoftwareStructure.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Structure </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><b>Seismo-VLAB</b> is divided into two main processes:</p><ul>
<li>The <a class="el" href="linkSoftwareStructure.html#linkPreProcess">Pre-Analysis</a></li>
<li>The <a class="el" href="linkSoftwareStructure.html#linkRunProcess">Run-Analysis</a></li>
</ul>
<div class="image">
<img src="ProgramStructure.png" alt="ProgramStructure.png" width="25%"/>
</div>
<h1><a class="anchor" id="linkPreProcess"></a>
Pre-Analysis</h1>
<p>The <b>Pre-Analysis</b> consists on a set of Python routines that allows to construct a finite element model. This interface is designed to be user friendly and to handle large models in different formats. The main task is orchestrated by two main scripts: <span style="color:green"><b>01-Pre_Process/Core/SeismoVLAB.py</b></span> that essentially loads all required modules to generate a model; and <span style="color:green"><b>01-Pre_Process/Core/Definitions.py</b></span> that contains the data structure (dictionaries) that stores the finite element information to be transformed into <a class="el" href="linkSoftwareStructure.html#linkRunProcess">Run-Analysis</a> input files. A normal <b>Pre-Analysis</b> execution diagram is illustrated in the following figure:</p>
<div class="image">
<img src="PreAnalysis.png" alt="PreAnalysis.png" width="50%"/>
</div>
<p>As it is shown, the <b>Pre-Analysis</b> handles the degree-of-freedom numbering in <span style="color:green"><b>01-Pre_Process/Core/Numberer.py</b></span>, the domain partition in <span style="color:green"><b>01-Pre_Process/Core/Partition.py</b></span>, soil spatial variability in <span style="color:green"><b>01-Pre_Process/Core/RandomField.py</b></span>, and domain reduction forces in <span style="color:green"><b>01-Pre_Process/Core/PlaneWave.py</b></span>. The <b>Pre-Analysis</b> also allows the user to parse formats from other softwares. For example, <b>ETABS</b> (.e2k) and <b>SAP</b> (.s2k) are currently available. Basic features such as node, material, element, restriction are transformed into <b>SVL</b> format, but they can be manipulated using Python to include other features.</p>
<p>The <b>Pre-Analysis</b> also offers several routines that are provided in the <span style="color:green"><b>01-Pre_Process/Method/Attach.py</b></span> that allows the user to create/append new entities using a Python interface. Then, a user can take full advantage of all the features available in Python to manipulate, modify and create a finite element model.</p>
<dl class="section attention"><dt>Attention</dt><dd>The <b>SVL</b> modules are discussed in further details at <a class="el" href="linkModules.html">Modules</a></dd></dl>
<h1><a class="anchor" id="linkRunProcess"></a>
Run-Analysis</h1>
<p>The <b>Run-Analysis</b> is a C++ program that forms the main core of <b>SVL</b>. This process is in charge of generating the finite element model and performing the desired analysis. The <b>Run-Analysis</b> essentially generates the finite element matrices, assembles the contribution of each elements, and solves the resulting systems of equations to finally provided with the desired simulation results.</p>
<p>The <b>Run-Analysis</b> classes are stored in different folder so that the internal structure is better defined. For example, in the folders: <span style="color:green"><b>02-Run_Process/01-Node</b></span>, <span style="color:green"><b>02-Run_Process/02-Materials</b></span>, <span style="color:green"><b>02-Run_Process/03-Sections</b></span>, <span style="color:green"><b>02-Run_Process/04-Elements</b></span>, <span style="color:green"><b>02-Run_Process/05-Loads</b></span>, and <span style="color:green"><b>02-Run_Process/06-Mesh</b></span> the user will find all required classes to construct a finite element model. Similarly in folders such as: <span style="color:green"><b>02-Run_Process/08-Analysis</b></span>, <span style="color:green"><b>02-Run_Process/09-Algorithms</b></span>, <span style="color:green"><b>02-Run_Process/10-Integrators</b></span>, and <span style="color:green"><b>02-Run_Process/11-Solvers</b></span> contains all classes required to perform modifications on the finite element mesh. The <b>Run-Analysis</b> classes and their interaction are shown in the fugure below:</p>
<div class="image">
<img src="SeismoVLab_Program.png" alt="SeismoVLab_Program.png" width="40%"/>
</div>
<p>The figure above shows the main abstract classes employed to develop the <b>Run-Analysis</b>. In this diagram, the diamond arrow that arrives at an abstract class represents an internal relation between them, for example the <a class="el" href="classElement.html" title="Virtual class for creating an element in a mesh. ">Element</a> class is formed by <a class="el" href="classNode.html" title="Class for creating a node in space that handles coordinates, state variables, free and total degrees-...">Node</a> and <a class="el" href="classMaterial.html" title="Virtual class for creating a material object. ">Material</a>. The point arrow that arrives at an abstract class represents a dependency between them, for example a <a class="el" href="classLoad.html" title="Class for creating a load that can be applied to a node or to a element. ">Load</a> is given to an <a class="el" href="classElement.html" title="Virtual class for creating an element in a mesh. ">Element</a> to compute external forces. The diagram represents in blue boxes the main classes (core) of the <b>Run-Analysis</b>, classes represented in green boxes forms the geometry module, while classes represented in yellow forms the analysis module. The <b>Run-Analysis</b> class diagram is illustrated in the following figure:</p>
<div class="image">
<img src="Analysis_Member_Diagram.png" alt="Analysis_Member_Diagram.png" width="60%"/>
</div>
<p>The flowchart starts at execution of the public member function <a class="el" href="classAnalysis.html#a13e64fdb25b141c9fb26a87576de0420" title="Performs the required analysis on the domain. ">Analysis::Analyze()</a>. After this execution, the <a class="el" href="classRecorder.html" title="Class that stores the node, element, and section responses for a given analysis. ">Recorder</a> is immediately initialized using <a class="el" href="classRecorder.html#a38a1396b7e978c5e6b89695e23cfbf39" title="Initialize the recorder. ">Recorder::Initialize</a>. Then, the <a class="el" href="classIntegrator.html#ade2662f0925875beb6c51fbf20fe8aff" title="Computes a new time step. ">Integrator::ComputeNewStep()</a> is called for each time step during the simulation. In each time step, the <a class="el" href="classAlgorithm.html#a3d98a95ddc8b615587d7b283012f1b92" title="Update the incremental state variables in the mesh. ">Algorithm::UpdateStatesIncrements()</a> member is called. Inside this function, the effective stiffness matrix and force vector are computed using the <a class="el" href="classAssembler.html" title="Class for assembling the finite element matrices and vector. ">Assembler</a>. The <a class="el" href="classAssembler.html" title="Class for assembling the finite element matrices and vector. ">Assembler</a> asks the <a class="el" href="classMesh.html" title="Class for defining a mesh that stores the nodes, materials, elements, and loads. ">Mesh</a> to provide with all <a class="el" href="classElement.html" title="Virtual class for creating an element in a mesh. ">Element</a> and Nodes so that the <a class="el" href="classElement.html#a7a3de7d3765b7f1a690c9ad68e5914ad" title="Compute the stiffness matrix of the element using gauss-integration or close form solutions...">Element::ComputeStiffnessMatrix()</a> and <a class="el" href="classElement.html#a44fd58f936c3e2452798f351b6fb896d" title="Compute the internal forces acting on the element. ">Element::ComputeInternalForces()</a> are for instance computed at each <a class="el" href="classElement.html" title="Virtual class for creating an element in a mesh. ">Element</a>. The <a class="el" href="classElement.html" title="Virtual class for creating an element in a mesh. ">Element</a> contribution is thus assembled into the global stiffness matrix and force vector. These quantities are passed to the Solver to obtain the solution of the linear system. The solution is retrieved in the <a class="el" href="classAlgorithm.html" title="Virtual class for defining how the solution between two steps is going to be carried out...">Algorithm</a> and used to update the incremental displacement at the public member function <a class="el" href="classAlgorithm.html#a3d98a95ddc8b615587d7b283012f1b92" title="Update the incremental state variables in the mesh. ">Algorithm::UpdateStatesIncrements()</a>. Here, a convergence test is performed:</p><ul>
<li>If the state increment does not reach a certain tolerance, then the displacement increment is updated, and the <a class="el" href="classElement.html#ae3707c66dc2119715065f74e169552e7" title="Save the material/section states in the element. ">Element::CommitState()</a> is performed. A new iteration is performed (right after the states have been updated) until convergence is reached.</li>
<li>If the tolerance is reached, then the domain is updated at <a class="el" href="classStaticAnalysis.html#ae04f3aa664cb77dab3cc673a7e9678c4" title="Performs changes in mesh. ">StaticAnalysis::UpdateDomain()</a> or <a class="el" href="classDynamicAnalysis.html#a50a3136b7f436c6381fed4c95274a562" title="Performs changes in mesh. ">DynamicAnalysis::UpdateDomain()</a>, and the <a class="el" href="classRecorder.html#ae01873999c1de0d6a87f2b34135fb165" title="Write information in the recorder. ">Recorder::WriteResponse()</a> is called so that the states at this time step are stored.</li>
</ul>
<p>Finally, after the domain has been updated, if the simulation reaches the last time step, then the <a class="el" href="classRecorder.html#a1be2313f3dad1690ab79cb73b3a1d9b2" title="Finalize the recorder. ">Recorder::Finalize()</a> is executed and the simulation is terminated, otherwise a new time step is computed.</p>
<dl class="section attention"><dt>Attention</dt><dd>The <b>SVL</b> modules are discussed in further details at <a class="el" href="linkModules.html">Modules</a></dd></dl>
<h1><a class="anchor" id="linkSVLworkflow"></a>
The Workflow</h1>
<p><b>SVL</b> involves two independent execution:</p>
<ul>
<li>First, the <a class="el" href="linkSoftwareStructure.html#linkPreProcess">Pre-Analysis</a> (generation) is executed as: <div class="fragment"><div class="line">python3 &#39;/path/to/Script.py&#39;</div></div><!-- fragment --></li>
<li>Second, the <a class="el" href="linkSoftwareStructure.html#linkRunProcess">Run-Analysis</a> (simulation) is executed as:<ul>
<li>One processor (single core)<br />
<div class="fragment"><div class="line">/path/to/SeismoVLAB.exe -dir &#39;/path/to/Partition/Folder&#39; -file &#39;File.$.json&#39;</div></div><!-- fragment --></li>
<li>Multi Processor (many core)<br />
<div class="fragment"><div class="line">mpirun -np n /path/to/SeismoVLab.exe -dir &#39;/path/to/Partition/Folder&#39; -file &#39;File.$.json&#39;</div></div><!-- fragment --></li>
</ul>
</li>
</ul>
<p>The communication or link between the <a class="el" href="linkSoftwareStructure.html#linkPreProcess">Pre-Analysis</a> and the <a class="el" href="linkSoftwareStructure.html#linkRunProcess">Run-Analysis</a> is done through input and output file as shown below.</p>
<div class="image">
<img src="SVL_Execution.png" alt="SVL_Execution.png" width="60%"/>
</div>
<p>The generated input and output files during a <b>SVL</b> execution are:</p>
<ul>
<li><code>./Script.py</code> : Main python file (generated by the user) employed to create the finite element model. The <b>Pre-Analysis</b> python file is described in <a class="el" href="linkModules.html">Modules</a>. We insist on this process can be skipped as long as the <code>File.$.json</code> is written in <b>Run-Analysis</b> format.</li>
<li><code>./Partition/File.$.json</code> : Set of partitioned input files generated in <b>Pre-Analysis</b> and written in <b>Run-Analysis</b> json format. Note that the <code>.$.</code> represents the processor number. Each one of these files contains a subdomain of the finite element model.</li>
<li><code>./Solution/Response.out</code> : Output files specified by the user that include <a class="el" href="linkElement.html">Element</a>, <a class="el" href="linkNode.html">Node</a>, <a class="el" href="linkMaterial.html">Material</a>, or <a class="el" href="linkSection.html">Section</a> responses.</li>
<li><code>./Paraview/Animation_PART$.n.vtk</code> : These are <b>VTK</b> output files that can be displayed using <a class="el" href="linkParaview.html">ParaView</a>. In the output file format <code>$</code> represents the partition number and <code>n</code> the iteration or time step.</li>
</ul>
<p>We have decided to generate the <a class="el" href="classMesh.html" title="Class for defining a mesh that stores the nodes, materials, elements, and loads. ">Mesh</a> partitions and the degree of freedom numbering off-line using the <b>Pre-Analysis</b>. This allows <b>Seismo-VLAB</b> to be run almost fully parallel, avoiding the user to make mistakes by partitioning the domain manually. The <a class="el" href="classMesh.html" title="Class for defining a mesh that stores the nodes, materials, elements, and loads. ">Mesh</a> partition can be easily checked using <a class="el" href="linkParaview.html">ParaView</a> (<a href="https://www.paraview.org/">https://www.paraview.org/</a>) after executing the <b>Pre-Analysis</b>. This information is stored in the <code>File.$.json</code> files that are loaded in the <b>Run-Analysis</b> (using the function <span style="color:blue"><b>renderData()</b></span> located at <span style="color:green"><b>01-Pre_Process/Method/Display.py</b></span>).</p>
<dl class="section attention"><dt>Attention</dt><dd>The <b>Pre-Analysis</b> can be fully replaced by another program as long as the output files (<span style="color:blue"><b>./Partition/File.$.json</b></span>) are written using the <b>Run-Analysis</b> json format. </dd>
<dd>
The structure of the <b>JSON</b> format are discussed in <a class="el" href="linkGeometryModule.html">Geometry Module</a>, <a class="el" href="linkAnalysisModule.html">Solution Module</a>, and <a class="el" href="linkIOModule.html">Input/Output Module</a> in the <b>Run-Analysis</b> section for more details. </dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
		<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
			<ul>
				<li class="footer">
					Generated on Sat May 29 2021 13:32:27 for Seismo-VLAB by <a href="http://www.doxygen.org/index.html">
					<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13.
				</li>
			</ul>
		</div>
		<script src="custom.js"></script>
	</body>
</html>
