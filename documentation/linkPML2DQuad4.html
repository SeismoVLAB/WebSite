<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=9"/>
		<meta name="generator" content="Doxygen 1.8.13"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		<title>Seismo-VLAB: PML2DQuad4</title>
		<link href="tabs.css" rel="stylesheet" type="text/css"/>
		<script type="text/javascript" src="jquery.js"></script>
		<script type="text/javascript" src="dynsections.js"></script>
		<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
		<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
		<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
		<link href="doxygen.css" rel="stylesheet" type="text/css" />
		<link href="Style.css" rel="stylesheet" type="text/css"/>
	</head>
	<body>
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectlogo"><img alt="Logo" src="Logo.png"/></td>
						<td id="projectalign" style="padding-left: 0.5em;">
							<div id="projectname">Seismo-VLAB
								&#160;<span id="projectnumber">1.3</span>
							</div>
							<div id="projectbrief">An Open-Source Finite Element Software for Meso-Scale Simulations</div>
						</td>
						<td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('linkPML2DQuad4.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title"><a class="el" href="classPML2DQuad4.html" title="Class for creating a 2D linearized four-node perfectly matched layer element in a mesh...">PML2DQuad4</a> </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>Background</h1>
<p>The <a class="el" href="classPML2DQuad4.html" title="Class for creating a 2D linearized four-node perfectly matched layer element in a mesh...">PML2DQuad4</a> class creates a plane strain perfectly matched layer (PML) element with four nodes, which can be used to define absorbing boundary layer to encapsulate the regular domain. This element is based on the symmetric hybrid formulation, which results in mixed finite element formulation (displacement and stress fields) in the PML elements. Each node of the PML element has five degrees of freedom, two of which for translation in X and Y directions and three of which for stress tensor histories.</p>
<p>The key idea in PML elements is the use of complex coordinate stretching. The complex stretching function in direction s-, which can be either x- or y- directions in the cartesian coordinate system, is defined as:</p>
<p class="formulaDsp">
\[ \epsilon_s(s,\omega) = \alpha_s(s)+\frac{\beta_s(s)}{i\omega} \]
</p>
<p>where \(\alpha_s\) and \(\beta_s\) are scaling and attenuation functions, respectively. The form of these functions are:</p>
<p class="formulaDsp">
\[ \alpha_s (s) = 1+\alpha_0\left [ \frac{(s-s_0)n_s}{L_\textrm{pml}}\right ]^m, \quad \beta_s (s) = \beta_0 \left [ \frac{(s-s_0)n_s}{L_\textrm{pml}}\right ]^m \]
</p>
<p>where \(m\) is the degree of the polynomial; \(n_s\) is the \(s\)th component of outward normal to the interface between PML region and the regular domain; \(L_\textrm{pml}\) is the thickness of the PML region; and \(s_0\) is the \(s\)th component of the reference point where stretching is defined. \(\alpha_0\) and \(\beta_0\) are defined as:</p>
<p class="formulaDsp">
\[ \alpha_0 = \frac{3b}{2L_\textrm{pml}}\log \frac{1}{R}, \quad \beta_0 = \frac{3V_\textrm{ref}}{2L_\textrm{pml}}\log \frac{1}{R} \]
</p>
<p>where \(b\) is a characteristic length and we set it to \(L_\textrm{pml}/10\); \(V_\textrm{ref}\) is a reference velocity, and \(R\) is a user-defined reflection coefficient. The Figure shows PML elements at different positions. The examples below show how to define the reference point &ndash; to start coordinate stretching &ndash; and the normal vector for each element \(E_i, i = 1,\dots, 5\).</p>
<div class="image">
<img src="PML2DQuad4.png" alt="PML2DQuad4.png" width="50%"/>
</div>
<p><b>REFERENCE:</b></p><ul>
<li>Kucukcoban, S., and Loukas F. Kallivokas. "A symmetric hybrid formulation for transient wave simulations in PML-truncated heterogeneous media." Wave Motion Vol 50. Issue 1 (2013): 57-79.</li>
</ul>
<h1>Pre-Analysis</h1>
<p>The python <a class="el" href="linkSoftwareStructure.html#linkPreProcess">Pre-Analysis</a> in the <span style="color:green"><b>01-Pre_Process/Method/Attach.py</b></span> file provides with an interface to populate the <code>Entities</code> dictionary. This file contains several functions to populate specific fields. For example, to create a <a class="el" href="classPML2DQuad4.html" title="Class for creating a 2D linearized four-node perfectly matched layer element in a mesh...">PML2DQuad4</a>, using json format, use:</p>
<ul>
<li><p class="startli"><span style="color:blue"><b>addElement</b></span>(<b>tag</b>, <b>name</b>='<a class="el" href="classPML2DQuad4.html" title="Class for creating a 2D linearized four-node perfectly matched layer element in a mesh...">PML2DQuad4</a>', <b>conn</b>, <b>attributes</b>):</p><ul>
<li><span style="color:green"><b>tag</b></span> : The identifier of this element, i.e., tag &gt; -1</li>
<li><span style="color:green"><b>name</b></span> : Seismo-VLAB element class name</li>
<li><span style="color:green"><b>conn</b></span> : Connectivity array of this element</li>
<li><span style="color:green"><b>attributes</b></span> : Specific properties for the created element, for example<ul>
<li><span style="color:blue">'material'</span> is material identifier. <br />
</li>
<li><span style="color:blue">'n'</span> is the polynomial degree. <br />
</li>
<li><span style="color:blue">'th'</span> is the thickness of a quad element. <br />
</li>
<li><span style="color:blue">'L'</span> is the Thickness of the PML region. <br />
</li>
<li><span style="color:blue">'R'</span> is the Reflection coefficient. <br />
</li>
<li><span style="color:blue">'x0'</span> is the PML coordinate of the reference point. <br />
</li>
<li><span style="color:blue">'npml'</span> is the vector of the outward normal. <br />
</li>
<li><span style="color:blue">'np'</span> Number of quadrature-points used for the integration.</li>
<li><span style="color:blue">'rule'</span> the integration rule: 'Gauss', 'Lobatto'. <br />
</li>
</ul>
</li>
</ul>
<p class="startli"><b>Example</b> </p><blockquote class="doxtable">
<p>A <b>PML2DQUAD4</b> element can be defined using the python interface as follows:<br />
SVL.addElement(<b>tag</b>=1, <b>name</b>='<a class="el" href="classPML2DQuad4.html" title="Class for creating a 2D linearized four-node perfectly matched layer element in a mesh...">PML2DQuad4</a>', <b>conn</b>=[1,2,3,4], <b>attributes</b>={'th': 0.01, 'material': 1, 'np': 4, 'rule': Gauss, 'x0': [], 'npml': [], 'L': 10.0}) </p>
</blockquote>
<p class="startli"><b>Application</b><br />
 Please refer to the <b>F11-DY_Lin_2DPMLSoilColumn_ElasticPStrain_Quad4.py</b> file located at <span style="color:green"><b>03-Validations/01-Debugging/</b></span> to see an example on how to define a <a class="el" href="classPML2DQuad4.html" title="Class for creating a 2D linearized four-node perfectly matched layer element in a mesh...">PML2DQuad4</a> element.</p>
</li>
</ul>
<p>On the contrary, the <span style="color:green"><b>01-Pre_Process/Method/Remove.py</b></span> file provides with an interface to depopulate the <code>Entities</code> dictionary. For example, to remove an already define <a class="el" href="classElement.html" title="Virtual class for creating an element in a mesh. ">Element</a>, use:</p><ul>
<li><span style="color:blue"><b>delElement</b></span>(<b>tag</b>):<ul>
<li><span style="color:green"><b>tag</b></span> : The identifier of the element to be removed, i.e., tag &gt; -1</li>
</ul>
</li>
</ul>
<h1>Run-Analysis</h1>
<p>The C++ <a class="el" href="linkSoftwareStructure.html#linkRunProcess">Run-Analysis</a> in the <span style="color:green"><b>02-Run_Process/04-Elements/06-Quadrilateral/PML2DQuad4.cpp</b></span> file provides the class implementation. A <a class="el" href="classPML2DQuad4.html" title="Class for creating a 2D linearized four-node perfectly matched layer element in a mesh...">PML2DQuad4</a> element is created using the built-in json parse-structure provided in the <a class="el" href="Parser_8hpp.html">Parser.hpp</a>. A <a class="el" href="classPML2DQuad4.html" title="Class for creating a 2D linearized four-node perfectly matched layer element in a mesh...">PML2DQuad4</a> is defined inside the <span style="color:black"><b>"Elements"</b></span> json field indicating its <span style="color:blue"><b>"Tag"</b></span> as follows,</p><ul>
<li><pre style="padding: 0px; color: black; background-color: white; border: white 0px solid">
{
    <span style="color:black"><b>"Elements"</b></span>: {
        <span style="color:blue"><b>"Tag"</b></span>: {
            <span style="color:green"><b>"name"</b></span> : "PML2DQUAD4",
            <span style="color:green"><b>"conn"</b></span> : [ ],
            <span style="color:green"><b>"attributes"</b></span>: {
                <span style="color:maroon"><b>"th"</b></span>: double,
                <span style="color:maroon"><b>"n"</b></span>: double,
                <span style="color:maroon"><b>"L"</b></span>: double,
                <span style="color:maroon"><b>"R"</b></span>: double,
                <span style="color:maroon"><b>"x0"</b></span>: [ ],
                <span style="color:maroon"><b>"npml"</b></span>: [ ],
                <span style="color:maroon"><b>"np"</b></span>: int,
                <span style="color:maroon"><b>"rule"</b></span>: str,
                <span style="color:maroon"><b>"material"</b></span>: int
            }
        }
    }
}
</pre> <table class="doxtable">
<tr>
<th>Variable </th><th>Description  </th></tr>
<tr>
<td><code>Tag</code> </td><td>Unique element object identifier. </td></tr>
<tr>
<td><code>conn</code> </td><td>The element connectivity node array. </td></tr>
<tr>
<td><code>th</code> </td><td>The thickness of the element. </td></tr>
<tr>
<td><code>n</code> </td><td>Polynomial degree. </td></tr>
<tr>
<td><code>L</code> </td><td>Thickness of the PML region. </td></tr>
<tr>
<td><code>R</code> </td><td>Reflection coefficient. </td></tr>
<tr>
<td><code>x0</code> </td><td>Coordinates \((x_0,y_0)\) of the reference point. </td></tr>
<tr>
<td><code>npml</code> </td><td>Vector components \((n_x,n_y)\) of the outward normal. </td></tr>
<tr>
<td><code>np</code> </td><td>Number of quadrature-points used for the integration. </td></tr>
<tr>
<td><code>rule</code> </td><td>The quadrature integration name <code>rule</code>=GAUSS, LOBATTO. </td></tr>
<tr>
<td><code>material</code></td><td>The biaxial material identifier. </td></tr>
</table>
<br />
<dl class="section attention"><dt>Attention</dt><dd>This formulation only allows small deformations. </dd>
<dd>
<a class="el" href="classMaterial.html" title="Virtual class for creating a material object. ">Material</a> non-linearity is not tested in this element. </dd>
<dd>
Currently the number of integration points <code>np</code>= 1,4,9,16,25,36,49 are supported, another value assumes <code>np</code>=4. </dd>
<dd>
The material is considered to be the same at each quadrature point. </dd>
<dd>
The domain reduction force method is not compatible with this element. </dd>
<dd>
For the spatial extent of the PML layer&ndash;i.e., \(\textrm{L}_\textrm{pml}\), it is problem specific, but as a rule of thumb, considering one wavelength associated with the dominant frequency should work in general. </dd>
<dd>
For the PML element size, one can consider about 12 points in one wavelength. Once the mesh size is fixed, satisfying CFL condition to determine \(\Delta_\textrm{t}\) (i.e, \(\Delta_\textrm{t} \leq 0.3\,\Delta_\textrm{h}/V_p\), with \(V_p\) the p-wave velocity) for time marching.</dd></dl>
<b>Example</b> <blockquote class="doxtable">
<p>Consider the white domain of <b>PML2DQUAD4</b> elements showed in Figure with D = 5, L = 20, and H = 10.<br />
 {<br />
 "Elements": {<br />
 "1": { "name" : "PML2DQUAD4", "conn" : [1,2,3,4], "attributes": { "th": 1.0, "n": 2.0, "L": 5.0, "R": 0.001, "x0": [5,10], "npml": [-1.0, 0.0], "np": 4, "rule": "GAUSS", "material": 1 } },<br />
 "2": { "name" : "PML2DQUAD4", "conn" : [1,2,3,4], "attributes": { "th": 1.0, "n": 2.0, "L": 5.0, "R": 0.001, "x0": [5,5], "npml": [-0.707, -0.707], "np": 4, "rule": "GAUSS", "material": 1 } },<br />
 "3": { "name" : "PML2DQUAD4", "conn" : [1,2,3,4], "attributes": { "th": 1.0, "n": 2.0, "L": 5.0, "R": 0.001, "x0": [15,5], "npml": [0.0, -1.0], "np": 4, "rule": "GAUSS", "material": 1 } },<br />
 "4": { "name" : "PML2DQUAD4", "conn" : [1,2,3,4], "attributes": { "th": 1.0, "n": 2.0, "L": 5.0, "R": 0.001, "x0": [25,5], "npml": [0.707, -0.707], "np": 4, "rule": "GAUSS", "material": 1 } },<br />
 "5": { "name" : "PML2DQUAD4", "conn" : [1,2,3,4], "attributes": { "th": 1.0, "n": 2.0, "L": 5.0, "R": 0.001, "x0": [25,10], "npml": [1.0, 0.0], "np": 4, "rule": "GAUSS", "material": 1 } } }<br />
} </p>
</blockquote>
</li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
		<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
			<ul>
				<li class="footer">
					Generated on Fri Jun 11 2021 15:44:40 for Seismo-VLAB by <a href="http://www.doxygen.org/index.html">
					<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13.
				</li>
			</ul>
		</div>
		<script src="custom.js"></script>
	</body>
</html>
