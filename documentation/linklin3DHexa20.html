<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=9"/>
		<meta name="generator" content="Doxygen 1.8.13"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		<title>Seismo-VLAB: lin3DHexa20</title>
		<link href="tabs.css" rel="stylesheet" type="text/css"/>
		<script type="text/javascript" src="jquery.js"></script>
		<script type="text/javascript" src="dynsections.js"></script>
		<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
		<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
		<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
		<link href="doxygen.css" rel="stylesheet" type="text/css" />
		<link href="Style.css" rel="stylesheet" type="text/css"/>
	</head>
	<body>
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectlogo"><img alt="Logo" src="Logo.png"/></td>
						<td id="projectalign" style="padding-left: 0.5em;">
							<div id="projectname">Seismo-VLAB
								&#160;<span id="projectnumber">1.3</span>
							</div>
							<div id="projectbrief">An Open-Source Finite Element Software for Meso-Scale Simulations</div>
						</td>
						<td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('linklin3DHexa20.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title"><a class="el" href="classlin3DHexa20.html" title="Class for creating a 3D linearized twenty-node hexahedron element in a mesh. ">lin3DHexa20</a> </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>Background</h1>
<p>The <a class="el" href="classlin3DHexa20.html" title="Class for creating a 3D linearized twenty-node hexahedron element in a mesh. ">lin3DHexa20</a> class creates a linearized three-dimensional hexahedron element with twenty-nodes. Each node has three degrees-of-freedom, and each degree-of-freedom represents a translation in the X-, Y- and Z-directions. The figure provides a simple representation of this element in which the local coordinates are represented by the r-, s-, and t-axis, and (1), (2), (3), (4), \(\ldots\) (17), (18), (19) and (20) represent the nodes of the element respectively. The element mass, damping and stiffness matrices, as well as internal force vector are computed in global-coordinate. Numerical integration is performed to compute matrices and vectors.</p>
<div class="image">
<img src="lin3DHexa20.png" alt="lin3DHexa20.png" width="50%"/>
</div>
<p>The coordinates of any point \(x_1,x_2,x_3\) in the element is written in terms of the shape functions \(\textbf{N}_\textrm{i}(r, s, t)\) in the reference coordinates and the values of the i-th element nodal coordinates \(x^\textrm{(i)}_\textrm{j}\) as follows</p>
<p class="formulaDsp">
\[ x_\textrm{j}^\textrm{e}(r, s, t) = \sum_\textrm{i = 1}^{\textrm{N}_\textrm{n}} x^\textrm{(i)}_\textrm{j} \, \textbf{N}_\textrm{i}^\textrm{e}(r, s, t) \,. \]
</p>
<p>The same transformation is used to evaluate the displacements within the element&ndash;i.e., \(u_\textrm{j}^\textrm{e}(r, s ,t)\). Then, the displacement field is approximated as</p>
<p class="formulaDsp">
\[ u_\textrm{j}^\textrm{e}(r, s, t) = \sum_\textrm{i = 1}^{\textrm{N}_\textrm{n}} u^\textrm{(i)}_\textrm{j} \, \textbf{N}_\textrm{i}^\textrm{e}(r, s, t) \,. \]
</p>
<p>Since both the displacement field and the point element coordinates are approximated using the same shape function, this formulation is commonly known as isoparametric transformation. Computation of the strain-displacement matrix \(\textbf{B}^\textrm{e}(x_1,x_2,x_3)\) now requires to be mapped into the reference coordinate systems. Application of the chain rule for differentiation to the shape functions yields</p>
<p class="formulaDsp">
\[ \begin{bmatrix} \displaystyle{\frac{\partial N_\textrm{i}}{\partial r,}} \\ \displaystyle{\frac{\partial N_\textrm{i}}{\partial s}} \\ \displaystyle{\frac{\partial N_\textrm{i}}{\partial t}} \end{bmatrix} = \begin{bmatrix} \displaystyle{\frac{\partial x}{\partial r,}} &amp; \displaystyle{\frac{\partial y}{\partial r,}} &amp; \displaystyle{\frac{\partial z}{\partial r,}} \\ \displaystyle{\frac{\partial x}{\partial s}} &amp; \displaystyle{\frac{\partial y}{\partial s}} &amp; \displaystyle{\frac{\partial z}{\partial s}} \\ \displaystyle{\frac{\partial x}{\partial t}} &amp; \displaystyle{\frac{\partial y}{\partial t}} &amp; \displaystyle{\frac{\partial z}{\partial t}} \end{bmatrix} \begin{bmatrix} \displaystyle{\frac{\partial N_\textrm{i}}{\partial x}} \\ \displaystyle{\frac{\partial N_\textrm{i}}{\partial y}} \\ \displaystyle{\frac{\partial N_\textrm{i}}{\partial z}} \end{bmatrix} = \mathbf{J}^\textrm{e} \begin{bmatrix} \displaystyle{\frac{\partial N_\textrm{i}}{\partial x}} \\ \displaystyle{\frac{\partial N_\textrm{i}}{\partial y}} \\ \displaystyle{\frac{\partial N_\textrm{i}}{\partial z}} \end{bmatrix} \,, \]
</p>
<p>where \(\mathbf{J}^e: \mathbb{R}^3 \to \mathbb{R}^3\) is called the Jacobian matrix. Hence, derivatives in \(\textbf{B}^\textrm{e}(x_1,x_2,x_3)\) can be transformed into \(\textbf{B}^\textrm{e}(r,s,t)\) in the reference coordinates using the Jacobian matrix. The twenty shape functions \(\textbf{N}_\textrm{i}^\textrm{e}(r,s,t)\) required to evaluate the strain-displacement matrix \(\textbf{B}^\textrm{e}(r,s,t)\), shape function matrix \(\textbf{N}^\textrm{e}(r,s,t)\), and Jacobian matrix \(\textbf{J}^\textrm{e}(r,s,t)\) are:</p>
<p class="formulaDsp">
\[ \textbf{N}_\textrm{1}^\textrm{e}(r, s ,t) = -\frac{1}{8} (1 - r) (1 - s) (1 - t) (2 + r + s + t) \,, \\ \textbf{N}_\textrm{2}^\textrm{e}(r, s ,t) = -\frac{1}{8} (1 + r) (1 - s) (1 - t) (2 - r + s + t) \,, \\ \textbf{N}_\textrm{3}^\textrm{e}(r, s ,t) = -\frac{1}{8} (1 + r) (1 + s) (1 - t) (2 - r - s + t) \,, \\ \textbf{N}_\textrm{4}^\textrm{e}(r, s ,t) = -\frac{1}{8} (1 - r) (1 + s) (1 - t) (2 + r - s + t) \,, \\ \textbf{N}_\textrm{5}^\textrm{e}(r, s ,t) = -\frac{1}{8} (1 - r) (1 - s) (1 + t) (2 + r + s - t) \,, \\ \textbf{N}_\textrm{6}^\textrm{e}(r, s ,t) = -\frac{1}{8} (1 + r) (1 - s) (1 + t) (2 - r + s - t) \,, \\ \textbf{N}_\textrm{7}^\textrm{e}(r, s ,t) = -\frac{1}{8} (1 + r) (1 + s) (1 + t) (2 - r - s - t) \,, \\ \textbf{N}_\textrm{8}^\textrm{e}(r, s ,t) = -\frac{1}{8} (1 - r) (1 + s) (1 + t) (2 + r - s - t) \,, \\ \textbf{N}_\textrm{9}^\textrm{e}(r, s ,t) = -\frac{1}{4} (1 - r^2) (1 - s) (1 - t) \,, \\ \textbf{N}_\textrm{10}^\textrm{e}(r, s ,t) = \frac{1}{4} (1 + r) (1 - s^2) (1 - t) \,, \\ \textbf{N}_\textrm{11}^\textrm{e}(r, s ,t) = \frac{1}{4} (1 - r^2) (1 + s) (1 - t) \,, \\ \textbf{N}_\textrm{12}^\textrm{e}(r, s ,t) = \frac{1}{4} (1 - r) (1 - s^2) (1 - t) \,, \\ \textbf{N}_\textrm{13}^\textrm{e}(r, s ,t) = \frac{1}{4} (1 - r^2) (1 - s) (1 + t) \,, \\ \textbf{N}_\textrm{14}^\textrm{e}(r, s ,t) = \frac{1}{4} (1 + r) (1 - s^2) (1 + t) \,, \\ \textbf{N}_\textrm{15}^\textrm{e}(r, s ,t) = \frac{1}{4} (1 - r^2) (1 + s) (1 + t) \,, \\ \textbf{N}_\textrm{16}^\textrm{e}(r, s ,t) = \frac{1}{4} (1 - r) (1 - s^2) (1 + t) \,, \\ \textbf{N}_\textrm{17}^\textrm{e}(r, s ,t) = \frac{1}{4} (1 - r) (1 - s) (1 - t^2) \,, \\ \textbf{N}_\textrm{18}^\textrm{e}(r, s ,t) = \frac{1}{4} (1 + r) (1 - s) (1 - t^2) \,, \\ \textbf{N}_\textrm{19}^\textrm{e}(r, s ,t) = \frac{1}{4} (1 + r) (1 + s) (1 - t^2) \,, \\ \textbf{N}_\textrm{20}^\textrm{e}(r, s ,t) = \frac{1}{4} (1 - r) (1 + s) (1 - t^2) \,. \]
</p>
<p>The isoparametric transformation has the advantage that every element is treated in the same manner. In this regard, mass and stiffness matrices as well as force vector are evaluated using the same reference coordinates as follows</p>
<p class="formulaDsp">
\[ \textbf{M}^\textrm{e} = \int_{-1}^1 \int_{-1}^1 \int_{-1}^1 {\textbf{N}^\textrm{e}} (r, s,t)^\top \, \rho^\textrm{e} \, \textbf{N}^\textrm{e}(r, s,t) \det \mathbf{J}^\textrm{e} \, dr \, ds \, dt \,, \]
</p>
 <p class="formulaDsp">
\[ \textbf{K}^\textrm{e} = \int_{-1}^1 \int_{-1}^1 \int_{-1}^1 {\textbf{B}^\textrm{e}} (r, s,t)^\top \, \mathbb{C}^\textrm{e} \, \textbf{B}^\textrm{e}(r, s,t) \det \mathbf{J}^\textrm{e} \, dr \, ds \, dt \,, \]
</p>
 <p class="formulaDsp">
\[ \textbf{F}^\textrm{e} = \int_{-1}^1 \int_{-1}^1 \int_{-1}^1 {\textbf{N}^\textrm{e}} (r, s,t)^\top \, \textbf{F}_b^\textrm{e} \det \mathbf{J}^\textrm{e} \, dr \, ds \, dt \,, \]
</p>
<p>where \(\rho^\textrm{e}\) is the element density, \(\textbf{N}^\textrm{e}\) is the shape function matrix, \(\mathbb{C}^\textrm{e}\) is the material constitutive law, and \(\textbf{B}^\textrm{e}(r, s)\) is the well-known linear (material) strain-displacement matrix. Note that \(\textbf{M}^\textrm{e}, \textbf{K}^\textrm{e} \in \mathbb{R}^{\textrm{N}_\textrm{dof}^\textrm{e} \times \textrm{N}_\textrm{dof}^\textrm{e}}\) with \(\textrm{N}_\textrm{dof}^\textrm{e} = 60\) in this case.</p>
<p><b>REFERENCE:</b></p><ul>
<li>Bathe, K. Jurgen, "Finite Element Procedures", Chapter 5: pages 342-348. Prentice-Hall, 1996.</li>
</ul>
<h1>Pre-Analysis</h1>
<p>The python <a class="el" href="linkSoftwareStructure.html#linkPreProcess">Pre-Analysis</a> in the <span style="color:green"><b>01-Pre_Process/Method/Attach.py</b></span> file provides with an interface to populate the <code>Entities</code> dictionary. This file contains several functions to populate specific fields. For example, to create a <a class="el" href="classlin3DHexa20.html" title="Class for creating a 3D linearized twenty-node hexahedron element in a mesh. ">lin3DHexa20</a>, using json format, use:</p>
<ul>
<li><p class="startli"><span style="color:blue"><b>addElement</b></span>(<b>tag</b>, <b>name</b>='<a class="el" href="classlin3DHexa20.html" title="Class for creating a 3D linearized twenty-node hexahedron element in a mesh. ">lin3DHexa20</a>', <b>conn</b>, <b>attributes</b>):</p><ul>
<li><span style="color:green"><b>tag</b></span> : The identifier of this element, i.e., tag &gt; -1</li>
<li><span style="color:green"><b>name</b></span> : Seismo-VLAB element class name</li>
<li><span style="color:green"><b>conn</b></span> : Connectivity array of this element</li>
<li><span style="color:green"><b>attributes</b></span> : Specific properties for the created element, for example<ul>
<li><span style="color:blue">'material'</span> is material identifier. <br />
</li>
<li><span style="color:blue">'rule'</span> the integration rule: 'Gauss', 'Lobatto'. <br />
</li>
<li><span style="color:blue">'np'</span> Number of quadrature-points used for the integration.</li>
</ul>
</li>
</ul>
<p class="startli"><b>Example</b> </p><blockquote class="doxtable">
<p>A <b>LIN3DHEXA20</b> element can be defined using the python interface as follows:<br />
SVL.addElement(<b>tag</b>=1, <b>name</b>='<a class="el" href="classlin3DHexa20.html" title="Class for creating a 3D linearized twenty-node hexahedron element in a mesh. ">lin3DHexa20</a>', <b>conn</b>=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,14,16,17,18,19,20], <b>attributes</b>={'np': 27, 'rule': 'Gauss', 'material': 1}) </p>
</blockquote>
<p class="startli"><b>Application</b><br />
 Please refer to the <b>I03-ST_Lin_3DPointLoad_Elastic_Hexa20.py</b> file located at <span style="color:green"><b>03-Validations/01-Debugging/</b></span> to see an example on how to define a <a class="el" href="classlin3DHexa20.html" title="Class for creating a 3D linearized twenty-node hexahedron element in a mesh. ">lin3DHexa20</a> element.</p>
</li>
</ul>
<p>On the contrary, the <span style="color:green"><b>01-Pre_Process/Method/Remove.py</b></span> file provides with an interface to depopulate the <code>Entities</code> dictionary. For example, to remove an already define <a class="el" href="classElement.html" title="Virtual class for creating an element in a mesh. ">Element</a>, use:</p><ul>
<li><span style="color:blue"><b>delElement</b></span>(<b>tag</b>):<ul>
<li><span style="color:green"><b>tag</b></span> : The identifier of the element to be removed, i.e., tag &gt; -1</li>
</ul>
</li>
</ul>
<h1>Run-Analysis</h1>
<p>The C++ <a class="el" href="linkSoftwareStructure.html#linkRunProcess">Run-Analysis</a> in the <span style="color:green"><b>02-Run_Process/04-Elements/10-Hexahedron/lin3DHexa20.cpp</b></span> file provides the class implementation. A <a class="el" href="classlin3DHexa20.html" title="Class for creating a 3D linearized twenty-node hexahedron element in a mesh. ">lin3DHexa20</a> element is created using the built-in json parse-structure provided in the <a class="el" href="Parser_8hpp.html">Parser.hpp</a>. A <a class="el" href="classlin3DHexa20.html" title="Class for creating a 3D linearized twenty-node hexahedron element in a mesh. ">lin3DHexa20</a> is defined inside the <span style="color:black"><b>"Elements"</b></span> json field indicating its <span style="color:blue"><b>"Tag"</b></span> as follows,</p><ul>
<li><pre style="padding: 0px; color: black; background-color: white; border: white 0px solid">
{
    <span style="color:black"><b>"Elements"</b></span>: {
        <span style="color:blue"><b>"Tag"</b></span>: {
            <span style="color:green"><b>"name"</b></span> : "LIN3DHEXA20",
            <span style="color:green"><b>"conn"</b></span> : [ ],
            <span style="color:green"><b>"attributes"</b></span>: {
                <span style="color:maroon"><b>"np"</b></span>: int,
                <span style="color:maroon"><b>"rule"</b></span>: str,
                <span style="color:maroon"><b>"material"</b></span>: int
            }
        }
    }
}
</pre> <table class="doxtable">
<tr>
<th>Variable </th><th>Description  </th></tr>
<tr>
<td><code>Tag</code> </td><td>Unique element object identifier. </td></tr>
<tr>
<td><code>conn</code> </td><td>The element connectivity node array. </td></tr>
<tr>
<td><code>np</code> </td><td>Number of quadrature-points used for the integration. </td></tr>
<tr>
<td><code>rule</code> </td><td>The quadrature integration name <code>rule</code>=GAUSS, LOBATTO. </td></tr>
<tr>
<td><code>material</code></td><td>The biaxial material identifier. </td></tr>
</table>
<br />
<dl class="section attention"><dt>Attention</dt><dd>This formulation only allows small deformations. </dd>
<dd>
<a class="el" href="classMaterial.html" title="Virtual class for creating a material object. ">Material</a> non-linearity can be used in this element. </dd>
<dd>
The material is considered to be the same at each quadrature point. </dd>
<dd>
Currently the number of integration points <code>np</code>= 1,8,27,64 are supported. </dd>
<dd>
The domain reduction force method is compatible with this element. </dd>
<dd>
For the element size \(\Delta_\textrm{h}\) in wave propagation problems, one can consider about 12 points in one wavelength (this is 6 elements per wavelength) (the one with the maximum frequency). Once the mesh size is fixed, satisfying CFL condition to determine \(\Delta_\textrm{t}\) (i.e, \(\Delta_\textrm{t} \leq 0.9\,\Delta_\textrm{h}/V_p\), with \(V_p\) the p-wave velocity) for time marching is required.</dd></dl>
<b>Example</b> <blockquote class="doxtable">
<p>A <b>LIN3DHEXA20</b> with 27 integration points between nodes 1 to 20, made of material 0 is constructed as: <br />
 { "Elements": { "1": { "name" : "LIN3DHEXA20", "conn" : [1,2,3,4,5,6,7,8,9,10,11,12,13,14,14,16,17,18,19,20], "attributes": { "np": 27, "rule": "Gauss", "material": 0 } } } }</p>
</blockquote>
</li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
		<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
			<ul>
				<li class="footer">
					Generated on Sun May 16 2021 20:38:17 for Seismo-VLAB by <a href="http://www.doxygen.org/index.html">
					<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13.
				</li>
			</ul>
		</div>
		<script src="custom.js"></script>
	</body>
</html>
